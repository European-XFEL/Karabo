# [[[cog
# from setuptools_scm import get_version
# from os import path as op
# version = get_version(root='../..', relative_to=cog.inFile)
# cog.outl(f'{{% set version = "{version}" %}}')
# root = op.join(op.dirname(cog.inFile), '../..')
# root = op.abspath(root)
# cog.outl(f'{{% set project_root = "{root}" %}}')
# ]]]
# [[[end]]]

package:
  name: karabo-cpp
  version: {{ version }}

source:
  path: {{ project_root }}
  git_rev: {{ version }}

build:
  number: 0

requirements:
  build:
    - python=3.8
    - {{ compiler('c') }}
    - {{ compiler('cxx') }}
    - make
    - cmake>=3.14
    - clang-tools=13.0.0
    - log4cpp=1.1.3=xfel
    - boost=1.68=xfel
    - openssl
    - openmqc
    - openmq
    - nss=3.35=xfel
    - hdf5=1.10.2
    - icu
    # - sip
    - nlohmann_json
    - numpy=1.13.3
    - libtiff
    - pugixml=1.2=xfel
    - cppunit
    - mqtt_cpp
    - redisclient=1.0.3=xfel
    - amqp-cpp=4.3.16=xfel
  run:
    - python=3.8
    - numpy=1.22.3
    - log4cpp=1.1.3=xfel
    - boost=1.68=xfel
    - openssl
    - openmqc
    - openmq
    - nss=3.35=xfel
    - hdf5=1.10.2
    - icu
    # - sip
    - nlohmann_json
    - libtiff
    - pugixml=1.2=xfel
    - mqtt_cpp
    - redisclient=1.0.3=xfel
    - amqp-cpp=4.3.16=xfel

test:
  commands:
    - karabo-cppserver --help
    - karabo-brokermessagelogger --help
    - karabo-brokerrates --help
  files:
    - karabo-idxbuild
    - karabo-idxview

about:
  home: https://in.xfel.eu/readthedocs/docs/karabo/en/latest/index.html
  summary: 'Karabo is the name of European XFEL GmbHâ€™s homogeneous software
            framework.'
  description: |
    Karabo is a SCADA framework that allows the use of plugable
    distributed applications that can be remotely controlled.
  doc_url: https://in.xfel.eu/readthedocs/docs/karabo/en/latest/index.html
