# [[[cog
# import os, sys
# try:
#     from karabogui import _version
# except ImportError:
#     print('\nPlease run setup install so the version is generated')
# else:
#     from karabogui import globals
#     cog.outl(f'{{% set version = "{globals.GUI_VERSION}" %}}')
# ]]]
# [[[end]]]
{% set project_root = os.environ['CI_PROJECT_DIR'] %}

package:
  name: karabogui
  version: {{ version }}

source:
  path: {{ project_root }}
  git_rev: {{ version }}

build:
  number: 0
  entry_points:
    - karabo-gui=karabogui.programs.gui_runner:main
    - panel-runner=karabogui.programs.panel_runner:main
    - karabo-cinema=karabogui.programs.cinema:main
    - karabo-theatre=karabogui.programs.theatre:main
    - karabo-update-extensions=karabogui.dialogs.update_dialog:main

requirements:
  build:
  - python=3.6.6
  - jupyter_client
  - setuptools
  - setuptools_scm
  run:
    # [[[cog
    # import cog
    # import json
    # import subprocess
    # output = subprocess.check_output(['conda', 'list', '-n', 'karabogui', '--json'])
    # for dep in json.loads(output):
    #     entry = '- {}={}'.format(dep['name'], dep['version'])
    #     if 'build_string' in dep:
    #         entry += '={}'.format(dep['build_string'])
    #     cog.outl(entry)
    # ]]]
    # [[[end]]]

test:
  imports:
    - karabogui
    - karabo.native
    - karabo.common

