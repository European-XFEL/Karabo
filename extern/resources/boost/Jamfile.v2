# Boost.Numpy Library 

# http://www.boost.org/LICENSE_1_0.txt

# For more information, see http://www.boost.org

import python ;
import regex ;
import string ;

using python : <python>2.7 ;

project boost/numpy 
    :   source-location ../src
    :   requirements
        <library>/python
        <conditional>@numpy-includes
    ;

rule numpy-includes ( properties * )
{
  import feature ;

  local python-interpreter = [ feature.get-values python.interpreter : $(properties) ] ;
  if $(python-interpreter)
  {
    local full-cmd =
      $(python-interpreter[0])" -c \"import sys; from numpy.distutils import misc_util; sys.stdout.write(':'.join(misc_util.get_numpy_include_dirs()))\" " ;
    local output = [ SHELL $(full-cmd) ] ;
    local includes = [ regex.split $(output) ":" ] ;
    return <include>$(includes) ;
  }
}


# Base names of the source files for libboost_numpy
SOURCES = dtype scalars ndarray matrix ufunc numpy ;

lib boost_numpy 
    :   $(SOURCES).cpp
    :   <link>shared
    ;

boost-install boost_numpy ;
