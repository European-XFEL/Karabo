CUSTOM_BUILD=y
CWD=$(pwd)

CMAKE=$INSTALL_PREFIX/bin/cmake

if [ ! -f "$CMAKE" ]; then
        CMAKE=/usr/bin/cmake
fi

MQTT_CPP=mqtt_cpp-10.0.0

echo
echo "### Trying to build and install $MQTT_CPP"
echo
cmake_version=`$CMAKE --version`
echo "### $cmake_version"
echo
rm -rf $MQTT_CPP

if [ ! -d "$MQTT_CPP" ]; then
        tar -xf ${MQTT_CPP}.tar
fi
cd $MQTT_CPP

$CMAKE -Bbuild -H. -DCMAKE_INSTALL_PREFIX=$INSTALL_PREFIX \
      -DBOOST_ROOT=$INSTALL_PREFIX -DBoost_NO_BOOST_CMAKE=1 \
      -DMQTT_BUILD_TESTS=OFF -DMQTT_BUILD_EXAMPLES=OFF
$CMAKE --build build/ --target install

cd $CWD
